/*
 *  Todos os direitos reservados.
 *    * 
 */
package visitas.hoken.janelas.gerencia;
import java.awt.Desktop;
import java.awt.Font;
import java.awt.Toolkit;
import java.awt.event.KeyEvent;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.File;
import java.io.IOException;
import java.sql.SQLException;
import java.sql.Time;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.Action;
import javax.swing.DefaultListModel;
import javax.swing.ImageIcon;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.KeyStroke;
import javax.swing.RowFilter;
import javax.swing.UIManager;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableRowSorter;
import net.sf.jasperreports.engine.JRException;
import sun.text.resources.FormatData;
import visitas.hoken.backup.MySQLBackup;
import visitas.hoken.modelos.*;
import visitas.hoken.utils.*;
import visitas.hoken.controle.VisitasControleJanelas;
import visitas.hoken.persistencia.VendedorDao;
import visitas.hoken.persistencia.VisitasDAO;
import visitas.hoken.relatorios.classes.EnumRelatorios;
import visitas.hoken.relatorios.classes.RelatoriosJasper;

/**
 *
 * @author Elaine Cecília Gatto - Cissa (elainececiliagatto@gmail.com)
 */
public class JanelaVisitas extends javax.swing.JFrame {

    String data1, celular, fixo, recado, semana, nome, endereco, complemento;
    String bairro, cidade, estado, hora, vendedor_S, vendedor_P, CEP, indicacao;
    String diaSemana, buscaNome = "", buscaNome2 = "";
    Date data2;
    Time time;
    int codigo, idx;
    LocalDate ld;
    Utils u = new Utils();
    VisitasControleJanelas control = new VisitasControleJanelas();
    Vendedor v = new Vendedor();
    Visitas visita = new Visitas();
    Visitas visita2 = new Visitas();
    DefaultListModel lista = new DefaultListModel();
    List<Visitas> vis = new ArrayList<Visitas>();
    List<Visitas> vis2 = new ArrayList<Visitas>();
    JOptionPane jp;
    ImageIcon erro = new ImageIcon(getClass().getResource("/visitas/hoken/imagens/erro.png"));
    ImageIcon salvo = new ImageIcon(getClass().getResource("/visitas/hoken/imagens/salvar.png"));
    ImageIcon impressao = new ImageIcon(getClass().getResource("/visitas/hoken/imagens/impressao.png"));
    boolean inserir = false;
    DefaultTableModel modelo = new DefaultTableModel();
    
    //Table Models e Sorter
    VendedoresTableModel tableModel = new VendedoresTableModel();
    VisitasTableModel visitasTableModel = new VisitasTableModel();
    TableRowSorter sorter = new TableRowSorter<VisitasTableModel>(visitasTableModel);
    int codigoRelatorio;
    //ImprimirVisita imprimeV;

    /**
     * Creates new form JanelaVisitas
     */
    public JanelaVisitas() {
        initComponents();
        setIcon();
        UIManager.put("OptionPane.messageFont", new Font("Tahoma", Font.BOLD, 14));
        
        //Centralizar
        this.setLocationRelativeTo(null);
        DialogoImprimir.setLocationRelativeTo(null);
        DialogoAlteraVisita.setLocationRelativeTo(null);
        DialogoNovaVisita.setLocationRelativeTo(null);
        DialogoVendedor.setLocationRelativeTo(null);
        DialogoRelatorio.setLocationRelativeTo(null);
       
        //KEY MAPS
        jl_AlterarVisita.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_INTERVAL_SELECTION);
        jl_AlterarVisita.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_Q, 0), "up");
        jl_AlterarVisita.getActionMap().put("up", (Action) jl_AlterarVisita.getActionForKeyStroke(KeyStroke.getKeyStroke(KeyEvent.VK_KP_UP, 0)));
        jl_AlterarVisita.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_W, 0), "down");
        jl_AlterarVisita.getActionMap().put("down",
                (Action) jl_AlterarVisita.getActionForKeyStroke(KeyStroke.getKeyStroke(KeyEvent.VK_KP_DOWN, 0)));
        
        

    }
    
    //métodos do inserirVendedor
    
    public void cleanForms(){
        
        //Limpando formes
        jtf_codigoVendedor.setText(null);
        jtf_nome.setText(null);
        jtf_ativo.setSelected(true);
        
    }
    
    public void enableForms(){
        
      
       jtf_codigoVendedor.setEnabled(true);
       jtf_nome.setEnabled(true);
       jtf_ativo.setEnabled(true);
    }
    
    public void disableForms(){
       
       jtf_codigoVendedor.setEnabled(false);
       jtf_nome.setEnabled(false);
       jtf_ativo.setEnabled(false);
    }
    
    ///
    
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        DialogoNovaVisita = new javax.swing.JDialog();
        jLabel2 = new javax.swing.JLabel();
        jlabCEP = new javax.swing.JLabel();
        jftCEP = new javax.swing.JFormattedTextField();
        jlabBairro = new javax.swing.JLabel();
        jtfBairro = new javax.swing.JTextField();
        jlabCidade = new javax.swing.JLabel();
        jtfCidade = new javax.swing.JTextField();
        jlabEstado = new javax.swing.JLabel();
        jtfEstado = new javax.swing.JTextField();
        jlabEndereco = new javax.swing.JLabel();
        jtfEndereco = new javax.swing.JTextField();
        js_Meio = new javax.swing.JSeparator();
        jLabCompl = new javax.swing.JLabel();
        jtfComplemento = new javax.swing.JTextField();
        jLabTelFixo = new javax.swing.JLabel();
        jftfFixo = new javax.swing.JFormattedTextField();
        jLabTelCel = new javax.swing.JLabel();
        jftfCelular = new javax.swing.JFormattedTextField();
        jLabTelRec = new javax.swing.JLabel();
        jftfRecado = new javax.swing.JFormattedTextField();
        jLabNome = new javax.swing.JLabel();
        jtfNome = new javax.swing.JTextField();
        jdc_Data = new com.toedter.calendar.JDateChooser();
        jLabDataVisita = new javax.swing.JLabel();
        jLabHora = new javax.swing.JLabel();
        jfHora = new javax.swing.JFormattedTextField();
        jLabel3 = new javax.swing.JLabel();
        jbCadastrar = new javax.swing.JButton();
        jtfSemana = new javax.swing.JTextField();
        jlabIndicacao = new javax.swing.JLabel();
        jLabVenP = new javax.swing.JLabel();
        jLabVenS = new javax.swing.JLabel();
        jtfIndicacao = new javax.swing.JTextField();
        jcb_VendPrin = new javax.swing.JComboBox<>();
        jcb_VendSe = new javax.swing.JComboBox<>();
        jLabObservacoes = new javax.swing.JLabel();
        jsp_observacao = new javax.swing.JScrollPane();
        jta_observacao = new javax.swing.JTextArea();
        jtb_vendedor = new javax.swing.JButton();
        DialogoAlteraVisita = new javax.swing.JDialog();
        jLabel5 = new javax.swing.JLabel();
        jSeparator6 = new javax.swing.JSeparator();
        jLAV = new javax.swing.JLabel();
        jtf_AlterarVisita = new javax.swing.JTextField();
        jb_VisitaAlterar = new javax.swing.JButton();
        jtp_1 = new javax.swing.JTabbedPane();
        jScrollPane2 = new javax.swing.JScrollPane();
        jl_AlterarVisita = new javax.swing.JList<>();
        jp_alterar_salvar = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTable_Alterar = new javax.swing.JTable();
        jb_SalvarChange = new javax.swing.JButton();
        jb_CancelarChange = new javax.swing.JButton();
        DialogoImprimir = new javax.swing.JDialog();
        jLbIcone = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jtf_BuscarNomeImprimir = new javax.swing.JTextField();
        jScrollPane6 = new javax.swing.JScrollPane();
        jtable_visitas = new javax.swing.JTable();
        jtb_buscar = new javax.swing.JButton();
        jtb_imprimir = new javax.swing.JButton();
        jtb_fechar = new javax.swing.JButton();
        jcb_vendidos = new javax.swing.JCheckBox();
        jtb_limparfiltro = new javax.swing.JButton();
        jcb_canceladas = new javax.swing.JCheckBox();
        jtb_maisopcoes = new javax.swing.JButton();
        jtb_atualizarvisitas = new javax.swing.JButton();
        DialogoVendedor = new javax.swing.JDialog();
        jScrollPane4 = new javax.swing.JScrollPane();
        jTable_Imprimir = new javax.swing.JTable();
        jtf_codigoVendedor = new javax.swing.JTextField();
        jtf_nome = new javax.swing.JTextField();
        jtf_ativo = new javax.swing.JCheckBox();
        jLabel4 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jtb_save = new javax.swing.JButton();
        jtb_delete = new javax.swing.JButton();
        jtb_update = new javax.swing.JButton();
        jtb_close = new javax.swing.JButton();
        jtb_insert = new javax.swing.JButton();
        jLbIcone1 = new javax.swing.JLabel();
        DialogoRelatorio = new javax.swing.JDialog();
        jLbIcone2 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jcb_vendedoresrelatorio = new javax.swing.JComboBox<>();
        jcb_canceladosrelatorio = new javax.swing.JComboBox<>();
        jcb_vendidorelatorio = new javax.swing.JComboBox<>();
        jdc_datade = new com.toedter.calendar.JDateChooser();
        jdc_dataate = new com.toedter.calendar.JDateChooser();
        Hoken = new javax.swing.JLabel();
        BarraDeMenus = new javax.swing.JMenuBar();
        jMenu_Arquivo = new javax.swing.JMenu();
        jmi_Backup = new javax.swing.JMenuItem();
        jmi_Sair = new javax.swing.JMenuItem();
        jMenu_Vendedores = new javax.swing.JMenu();
        jMenuItem2 = new javax.swing.JMenuItem();
        jMenu_Visitas = new javax.swing.JMenu();
        jmi_NovaVisita = new javax.swing.JMenuItem();
        jmi_AlterarVisita = new javax.swing.JMenuItem();
        jmi_listavisitas = new javax.swing.JMenuItem();
        jSeparator4 = new javax.swing.JPopupMenu.Separator();
        jMenu_Relatorios = new javax.swing.JMenu();
        jmi_todasvisitas = new javax.swing.JMenuItem();
        jMenu_Sobre = new javax.swing.JMenu();

        DialogoNovaVisita.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        DialogoNovaVisita.setTitle("Hoken Visitas: Cadastrar Nova Visita");
        DialogoNovaVisita.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        DialogoNovaVisita.setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/visitas/hoken/imagens/h.jpeg")));
        DialogoNovaVisita.setMinimumSize(new java.awt.Dimension(640, 480));
        DialogoNovaVisita.setModal(true);
        DialogoNovaVisita.setName("Dialogo Nova Visita"); // NOI18N
        DialogoNovaVisita.setResizable(false);
        DialogoNovaVisita.setSize(new java.awt.Dimension(800, 600));

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/visitas/hoken/imagens/hoken.jpeg"))); // NOI18N
        jLabel2.setPreferredSize(new java.awt.Dimension(800, 78));

        jlabCEP.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jlabCEP.setText("CEP:");

        try {
            jftCEP.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("########")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        jftCEP.setToolTipText("Aperte Enter e Aguarde!");
        jftCEP.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jftCEP.setMinimumSize(new java.awt.Dimension(10, 30));
        jftCEP.setNextFocusableComponent(jtfEndereco);
        jftCEP.setPreferredSize(new java.awt.Dimension(6, 21));
        jftCEP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jftCEPActionPerformed(evt);
            }
        });

        jlabBairro.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jlabBairro.setText("Bairro:");

        jtfBairro.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtfBairro.setMinimumSize(new java.awt.Dimension(10, 30));
        jtfBairro.setNextFocusableComponent(jtfCidade);
        jtfBairro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfBairroActionPerformed(evt);
            }
        });

        jlabCidade.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jlabCidade.setText("Cidade:");

        jtfCidade.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtfCidade.setMinimumSize(new java.awt.Dimension(10, 30));
        jtfCidade.setNextFocusableComponent(jtfEstado);
        jtfCidade.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfCidadeActionPerformed(evt);
            }
        });

        jlabEstado.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jlabEstado.setText("Estado:");

        jtfEstado.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtfEstado.setMinimumSize(new java.awt.Dimension(10, 30));
        jtfEstado.setNextFocusableComponent(jftfFixo);
        jtfEstado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfEstadoActionPerformed(evt);
            }
        });

        jlabEndereco.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jlabEndereco.setText("Endereço:");

        jtfEndereco.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtfEndereco.setMinimumSize(new java.awt.Dimension(10, 30));
        jtfEndereco.setNextFocusableComponent(jtfComplemento);
        jtfEndereco.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfEnderecoActionPerformed(evt);
            }
        });

        js_Meio.setOrientation(javax.swing.SwingConstants.VERTICAL);

        jLabCompl.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabCompl.setText("Complemento:");

        jtfComplemento.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtfComplemento.setMinimumSize(new java.awt.Dimension(10, 30));
        jtfComplemento.setNextFocusableComponent(jtfBairro);
        jtfComplemento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfComplementoActionPerformed(evt);
            }
        });

        jLabTelFixo.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabTelFixo.setText("Telefone Fixo:");

        try {
            jftfFixo.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("(##) #### - ####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        jftfFixo.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jftfFixo.setNextFocusableComponent(jftfCelular);
        jftfFixo.setPreferredSize(new java.awt.Dimension(6, 21));
        jftfFixo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jftfFixoActionPerformed(evt);
            }
        });

        jLabTelCel.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabTelCel.setText("Telefone Celular:");

        try {
            jftfCelular.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("(##) # - #### - ####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        jftfCelular.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jftfCelular.setNextFocusableComponent(jftfRecado);
        jftfCelular.setPreferredSize(new java.awt.Dimension(6, 21));
        jftfCelular.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jftfCelularActionPerformed(evt);
            }
        });

        jLabTelRec.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabTelRec.setText("Telefone Recado:");

        try {
            jftfRecado.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("(##) ##### - ####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        jftfRecado.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jftfRecado.setNextFocusableComponent(jbCadastrar);
        jftfRecado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jftfRecadoActionPerformed(evt);
            }
        });

        jLabNome.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabNome.setText("Nome:");

        jtfNome.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtfNome.setToolTipText("Digite o Nome Completo sem abreviaturas e aperte ENTER!");
        jtfNome.setMinimumSize(new java.awt.Dimension(10, 30));
        jtfNome.setName("NomePessoa"); // NOI18N
        jtfNome.setNextFocusableComponent(jdc_Data);
        jtfNome.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfNomeActionPerformed(evt);
            }
        });

        jdc_Data.setToolTipText("Escolha a data da visita");
        jdc_Data.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jdc_Data.setMinimumSize(new java.awt.Dimension(30, 30));
        jdc_Data.setNextFocusableComponent(jtfSemana);
        jdc_Data.setPreferredSize(new java.awt.Dimension(6, 21));
        jdc_Data_Acao();
        jtfSemana.requestFocus();

        jLabDataVisita.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabDataVisita.setText("Data:");

        jLabHora.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabHora.setText("Hora:");

        jfHora.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(java.text.DateFormat.getTimeInstance(java.text.DateFormat.SHORT))));
        jfHora.setToolTipText("Aperte ENTER após digitar!");
        jfHora.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jfHora.setMinimumSize(new java.awt.Dimension(10, 30));
        jfHora.setNextFocusableComponent(jtfIndicacao);
        jfHora.setPreferredSize(new java.awt.Dimension(6, 21));
        jfHora.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jfHoraActionPerformed(evt);
            }
        });

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel3.setText("Dia da Semana:");

        jbCadastrar.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jbCadastrar.setText("CADASTRAR");
        jbCadastrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbCadastrarActionPerformed(evt);
            }
        });

        jtfSemana.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtfSemana.setToolTipText("O dia da semana é preenchido automaticamente");
        jtfSemana.setMinimumSize(new java.awt.Dimension(10, 30));
        jtfSemana.setNextFocusableComponent(jfHora);
        jtfSemana.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfSemanaActionPerformed(evt);
            }
        });

        jlabIndicacao.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jlabIndicacao.setText("Indicação:");

        jLabVenP.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabVenP.setText("Vendedor Principal:");

        jLabVenS.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabVenS.setText("Vendedor Secundário:");

        jtfIndicacao.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jtfIndicacao.setToolTipText("Pessoa que indicou esta visita.");
        jtfIndicacao.setNextFocusableComponent(jcb_VendPrin);
        jtfIndicacao.setPreferredSize(new java.awt.Dimension(6, 21));
        jtfIndicacao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtfIndicacaoActionPerformed(evt);
            }
        });

        jcb_VendPrin.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jcb_VendPrin.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        jcb_VendPrin.setToolTipText("Obrigatório Escolher Um Vendedor!");
        jcb_VendPrin.setNextFocusableComponent(jcb_VendSe);
        jcb_VendPrin.removeAllItems();
        jcb_VendPrin.addItem("");
        List<visitas.hoken.modelos.Vendedor> vendp = control.Vendedores();
        for (visitas.hoken.modelos.Vendedor v : vendp) {
            jcb_VendPrin.addItem(v.getNomeVendedor());
        }

        jcb_VendSe.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jcb_VendSe.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        jcb_VendSe.setToolTipText("Opcional");
        jcb_VendSe.setNextFocusableComponent(jta_observacao);
        jcb_VendSe.removeAllItems();
        jcb_VendSe.addItem("");
        List<visitas.hoken.modelos.Vendedor> vends = control.Vendedores();
        for (visitas.hoken.modelos.Vendedor v : vends) {
            jcb_VendSe.addItem(v.getNomeVendedor());
        }
        jcb_VendSe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jcb_VendSeActionPerformed(evt);
            }
        });

        jLabObservacoes.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabObservacoes.setText("Observações:");

        jta_observacao.setColumns(20);
        jta_observacao.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jta_observacao.setRows(5);
        jta_observacao.setNextFocusableComponent(jftCEP);
        jsp_observacao.setViewportView(jta_observacao);

        jtb_vendedor.setText("Cadastrar Vendedor");
        jtb_vendedor.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_vendedorActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout DialogoNovaVisitaLayout = new javax.swing.GroupLayout(DialogoNovaVisita.getContentPane());
        DialogoNovaVisita.getContentPane().setLayout(DialogoNovaVisitaLayout);
        DialogoNovaVisitaLayout.setHorizontalGroup(
            DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                                .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabNome)
                                            .addComponent(jLabDataVisita))
                                        .addGap(74, 74, 74)
                                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addComponent(jdc_Data, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jtfNome, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabVenS)
                                            .addComponent(jLabVenP))
                                        .addGap(18, 18, 18)
                                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jcb_VendPrin, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jcb_VendSe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jlabIndicacao)
                                            .addComponent(jLabHora)
                                            .addComponent(jLabel3))
                                        .addGap(26, 26, 26)
                                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jtfSemana, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jfHora, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jtfIndicacao, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addComponent(jtb_vendedor))
                                .addGap(64, 64, 64))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, DialogoNovaVisitaLayout.createSequentialGroup()
                                .addComponent(jLabObservacoes)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jsp_observacao, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                        .addComponent(js_Meio, javax.swing.GroupLayout.PREFERRED_SIZE, 7, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                                .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jlabCEP)
                                    .addComponent(jlabEndereco)
                                    .addComponent(jLabCompl)
                                    .addComponent(jlabBairro)
                                    .addComponent(jlabCidade)
                                    .addComponent(jlabEstado)
                                    .addComponent(jLabTelFixo)
                                    .addComponent(jLabTelRec))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(jftfRecado, javax.swing.GroupLayout.DEFAULT_SIZE, 200, Short.MAX_VALUE)
                                    .addComponent(jftfFixo, javax.swing.GroupLayout.DEFAULT_SIZE, 200, Short.MAX_VALUE)
                                    .addComponent(jtfEstado, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jtfBairro, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jtfComplemento, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jtfEndereco, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jftCEP, javax.swing.GroupLayout.DEFAULT_SIZE, 200, Short.MAX_VALUE)
                                    .addComponent(jtfCidade, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                            .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                                .addComponent(jLabTelCel)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jftfCelular, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                        .addGap(89, 89, 89)
                        .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 642, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                        .addGap(326, 326, 326)
                        .addComponent(jbCadastrar)))
                .addContainerGap(62, Short.MAX_VALUE))
        );
        DialogoNovaVisitaLayout.setVerticalGroup(
            DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                        .addGap(24, 24, 24)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jftCEP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jlabCEP))
                        .addGap(12, 12, 12)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jtfEndereco, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jlabEndereco))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jtfComplemento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabCompl))
                        .addGap(14, 14, 14)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jlabBairro)
                            .addComponent(jtfBairro, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jlabCidade)
                            .addComponent(jtfCidade, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jlabEstado)
                            .addComponent(jtfEstado, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jftfFixo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabTelFixo))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabTelCel)
                            .addComponent(jftfCelular, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(15, 15, 15)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jftfRecado, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabTelRec)))
                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addComponent(js_Meio, javax.swing.GroupLayout.PREFERRED_SIZE, 348, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(DialogoNovaVisitaLayout.createSequentialGroup()
                        .addGap(35, 35, 35)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabNome)
                            .addComponent(jtfNome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jLabDataVisita, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jdc_Data, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel3)
                            .addComponent(jtfSemana, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jLabHora)
                            .addComponent(jfHora, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(12, 12, 12)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jlabIndicacao)
                            .addComponent(jtfIndicacao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabVenP)
                            .addComponent(jcb_VendPrin, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabVenS)
                            .addComponent(jcb_VendSe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jtb_vendedor)
                        .addGap(18, 18, 18)
                        .addGroup(DialogoNovaVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jLabObservacoes)
                            .addComponent(jsp_observacao, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jbCadastrar)
                .addGap(25, 25, 25))
        );

        DialogoAlteraVisita.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        DialogoAlteraVisita.setTitle("Hoken Visitas: Alterar Informações de Visita já Cadastrada");
        DialogoAlteraVisita.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        DialogoAlteraVisita.setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/visitas/hoken/imagens/h.jpeg")));
        DialogoAlteraVisita.setMaximumSize(null);
        DialogoAlteraVisita.setMinimumSize(new java.awt.Dimension(640, 480));
        DialogoAlteraVisita.setModal(true);
        DialogoAlteraVisita.setName("Dialogo Alterar Visita"); // NOI18N
        DialogoAlteraVisita.setPreferredSize(new java.awt.Dimension(800, 600));
        DialogoAlteraVisita.setSize(new java.awt.Dimension(800, 600));

        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/visitas/hoken/imagens/hoken.jpeg"))); // NOI18N
        jLabel5.setPreferredSize(new java.awt.Dimension(800, 78));

        jSeparator6.setPreferredSize(new java.awt.Dimension(1024, 10));

        jLAV.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLAV.setText("Digite parte do nome que deseja procurar:");

        jtf_AlterarVisita.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtf_AlterarVisita.setToolTipText("");
        jtf_AlterarVisita.setNextFocusableComponent(jb_VisitaAlterar);
        jtf_AlterarVisita.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtf_AlterarVisitaActionPerformed(evt);
            }
        });
        jtf_AlterarVisita.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jtf_AlterarVisitaKeyPressed(evt);
            }
        });

        jb_VisitaAlterar.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jb_VisitaAlterar.setForeground(new java.awt.Color(102, 0, 0));
        jb_VisitaAlterar.setText("Procurar");
        jb_VisitaAlterar.setNextFocusableComponent(jl_AlterarVisita);
        jb_VisitaAlterar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_VisitaAlterarActionPerformed(evt);
            }
        });

        jtp_1.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jl_AlterarVisita.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jl_AlterarVisita.setModel(new javax.swing.AbstractListModel<String>() {
            String[] strings = { "Item 1", "Item 2", "Item 3", "Item 4", "Item 5" };
            public int getSize() { return strings.length; }
            public String getElementAt(int i) { return strings[i]; }
        });
        jl_AlterarVisita.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jl_AlterarVisitaMouseClicked(evt);
            }
        });
        jl_AlterarVisita.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
            public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
                jl_AlterarVisitaValueChanged(evt);
            }
        });
        jScrollPane2.setViewportView(jl_AlterarVisita);

        jtp_1.addTab("Resultado da Busca", jScrollPane2);

        jTable_Alterar.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jTable_Alterar.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jTable_Alterar.setColumnSelectionAllowed(true);
        jScrollPane3.setViewportView(jTable_Alterar);
        jTable_Alterar.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);

        javax.swing.GroupLayout jp_alterar_salvarLayout = new javax.swing.GroupLayout(jp_alterar_salvar);
        jp_alterar_salvar.setLayout(jp_alterar_salvarLayout);
        jp_alterar_salvarLayout.setHorizontalGroup(
            jp_alterar_salvarLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_alterar_salvarLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 724, Short.MAX_VALUE)
                .addContainerGap())
        );
        jp_alterar_salvarLayout.setVerticalGroup(
            jp_alterar_salvarLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_alterar_salvarLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 338, Short.MAX_VALUE)
                .addContainerGap())
        );

        jtp_1.addTab("Alterar Visita e Salvar", jp_alterar_salvar);

        jb_SalvarChange.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jb_SalvarChange.setForeground(new java.awt.Color(102, 0, 51));
        jb_SalvarChange.setText("Salvar Alterações");
        jb_SalvarChange.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_SalvarChangeActionPerformed(evt);
            }
        });

        jb_CancelarChange.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jb_CancelarChange.setForeground(new java.awt.Color(102, 0, 0));
        jb_CancelarChange.setText("Cancelar/Limpar");
        jb_CancelarChange.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_CancelarChangeActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout DialogoAlteraVisitaLayout = new javax.swing.GroupLayout(DialogoAlteraVisita.getContentPane());
        DialogoAlteraVisita.getContentPane().setLayout(DialogoAlteraVisitaLayout);
        DialogoAlteraVisitaLayout.setHorizontalGroup(
            DialogoAlteraVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoAlteraVisitaLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(DialogoAlteraVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel5, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jSeparator6, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 0, Short.MAX_VALUE)
                    .addGroup(DialogoAlteraVisitaLayout.createSequentialGroup()
                        .addComponent(jLAV)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jtf_AlterarVisita, javax.swing.GroupLayout.PREFERRED_SIZE, 136, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jb_VisitaAlterar)
                        .addGap(18, 18, 18)
                        .addComponent(jb_SalvarChange)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jb_CancelarChange, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jtp_1))
                .addContainerGap(35, Short.MAX_VALUE))
        );
        DialogoAlteraVisitaLayout.setVerticalGroup(
            DialogoAlteraVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoAlteraVisitaLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator6, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(DialogoAlteraVisitaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jb_CancelarChange)
                    .addComponent(jb_SalvarChange)
                    .addComponent(jb_VisitaAlterar)
                    .addComponent(jtf_AlterarVisita, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLAV))
                .addGap(18, 18, 18)
                .addComponent(jtp_1)
                .addContainerGap())
        );

        DialogoAlteraVisita.getAccessibleContext().setAccessibleDescription("Janela para Alterar Informações de Visitas Cadastradas");

        DialogoImprimir.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        DialogoImprimir.setTitle("Hoken Visitas: Imprimir");
        DialogoImprimir.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        DialogoImprimir.setForeground(new java.awt.Color(255, 204, 204));
        DialogoImprimir.setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/visitas/hoken/imagens/h.jpeg")));
        DialogoImprimir.setLocation(new java.awt.Point(200, 200));
        DialogoImprimir.setMinimumSize(new java.awt.Dimension(640, 480));
        DialogoImprimir.setModal(true);
        DialogoImprimir.setResizable(false);
        DialogoImprimir.setSize(new java.awt.Dimension(640, 480));

        jLbIcone.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLbIcone.setIcon(new javax.swing.ImageIcon(getClass().getResource("/visitas/hoken/imagens/hoken.jpeg"))); // NOI18N
        jLbIcone.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        jLbIcone.setAlignmentX(0.5F);
        jLbIcone.setMaximumSize(new java.awt.Dimension(33000, 33000));
        jLbIcone.setMinimumSize(new java.awt.Dimension(300, 78));
        jLbIcone.setName("jLabelPrincipal"); // NOI18N
        jLbIcone.setPreferredSize(new java.awt.Dimension(800, 80));

        jLabel1.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabel1.setText("Digite o nome:");

        jtf_BuscarNomeImprimir.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jtf_BuscarNomeImprimir.setToolTipText("Digite o nome, aperte enter e aguarde!");
        jtf_BuscarNomeImprimir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtf_BuscarNomeImprimirActionPerformed(evt);
            }
        });
        jtf_BuscarNomeImprimir.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jtf_BuscarNomeImprimirKeyPressed(evt);
            }
        });

        jtable_visitas.setModel(visitasTableModel);
        jtable_visitas.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jtable_visitasMouseClicked(evt);
            }
        });
        jScrollPane6.setViewportView(jtable_visitas);

        jtb_buscar.setText("Buscar");
        jtb_buscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_buscarActionPerformed(evt);
            }
        });

        jtb_imprimir.setLabel("Imprimir");
        jtb_imprimir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_imprimirActionPerformed(evt);
            }
        });

        jtb_fechar.setLabel("Sair");
        jtb_fechar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_fecharActionPerformed(evt);
            }
        });

        jcb_vendidos.setText("Vendidos");
        jcb_vendidos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jcb_vendidosMouseClicked(evt);
            }
        });
        jcb_vendidos.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jcb_vendidosKeyPressed(evt);
            }
        });

        jtb_limparfiltro.setText("Limpar");
        jtb_limparfiltro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_limparfiltroActionPerformed(evt);
            }
        });

        jcb_canceladas.setText("Cancelada");
        jcb_canceladas.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jcb_canceladasMouseClicked(evt);
            }
        });

        jtb_maisopcoes.setText("Mais opções");

        jtb_atualizarvisitas.setText("Atualizar");
        jtb_atualizarvisitas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_atualizarvisitasActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout DialogoImprimirLayout = new javax.swing.GroupLayout(DialogoImprimir.getContentPane());
        DialogoImprimir.getContentPane().setLayout(DialogoImprimirLayout);
        DialogoImprimirLayout.setHorizontalGroup(
            DialogoImprimirLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoImprimirLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(DialogoImprimirLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane6)
                    .addGroup(DialogoImprimirLayout.createSequentialGroup()
                        .addComponent(jtb_imprimir)
                        .addGap(117, 117, 117)
                        .addComponent(jtb_atualizarvisitas)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jtb_maisopcoes)
                        .addGap(54, 54, 54)
                        .addComponent(jtb_fechar))
                    .addGroup(DialogoImprimirLayout.createSequentialGroup()
                        .addComponent(jLbIcone, javax.swing.GroupLayout.PREFERRED_SIZE, 579, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 18, Short.MAX_VALUE))
                    .addGroup(DialogoImprimirLayout.createSequentialGroup()
                        .addComponent(jLabel1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jtf_BuscarNomeImprimir, javax.swing.GroupLayout.PREFERRED_SIZE, 144, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jcb_vendidos)
                        .addGap(18, 18, 18)
                        .addComponent(jcb_canceladas)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jtb_buscar)
                        .addGap(18, 18, 18)
                        .addComponent(jtb_limparfiltro)))
                .addContainerGap())
        );
        DialogoImprimirLayout.setVerticalGroup(
            DialogoImprimirLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoImprimirLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLbIcone, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(DialogoImprimirLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(DialogoImprimirLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                        .addComponent(jtf_BuscarNomeImprimir, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel1)
                        .addComponent(jtb_buscar)
                        .addComponent(jtb_limparfiltro))
                    .addGroup(DialogoImprimirLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jcb_vendidos)
                        .addComponent(jcb_canceladas)))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 226, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addGroup(DialogoImprimirLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jtb_imprimir)
                    .addComponent(jtb_fechar)
                    .addComponent(jtb_maisopcoes)
                    .addComponent(jtb_atualizarvisitas))
                .addGap(30, 30, 30))
        );

        DialogoImprimir.getAccessibleContext().setAccessibleName("Hoken Visitas: Visitas");

        boolean inserir = false;
        this.disableForms();
        DialogoVendedor.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        DialogoVendedor.setModal(true);
        DialogoVendedor.setName("dialog_vendedor"); // NOI18N
        DialogoVendedor.setResizable(false);
        DialogoVendedor.setSize(new java.awt.Dimension(600, 415));

        jTable_Imprimir.setModel(tableModel);
        jTable_Imprimir.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable_ImprimirMouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(jTable_Imprimir);

        jtf_nome.setPreferredSize(new java.awt.Dimension(100, 20));

        jtf_ativo.setText("Ativo?");

        jLabel4.setText("Código");

        jLabel6.setText("Nome");

        jtb_save.setText("Salvar");
        jtb_save.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_saveActionPerformed(evt);
            }
        });

        jtb_delete.setText("Deletar");
        jtb_delete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_deleteActionPerformed(evt);
            }
        });

        jtb_update.setText("Alterar");
        jtb_update.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_updateActionPerformed(evt);
            }
        });

        jtb_close.setText("Fechar");
        jtb_close.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jtb_close.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_closeActionPerformed(evt);
            }
        });

        jtb_insert.setText("Inserir");
        jtb_insert.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jtb_insertActionPerformed(evt);
            }
        });

        jLbIcone1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLbIcone1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/visitas/hoken/imagens/hoken.jpeg"))); // NOI18N
        jLbIcone1.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        jLbIcone1.setAlignmentX(0.5F);
        jLbIcone1.setMaximumSize(new java.awt.Dimension(33000, 33000));
        jLbIcone1.setMinimumSize(new java.awt.Dimension(300, 78));
        jLbIcone1.setName("jLabelPrincipal"); // NOI18N
        jLbIcone1.setPreferredSize(new java.awt.Dimension(800, 80));

        javax.swing.GroupLayout DialogoVendedorLayout = new javax.swing.GroupLayout(DialogoVendedor.getContentPane());
        DialogoVendedor.getContentPane().setLayout(DialogoVendedorLayout);
        DialogoVendedorLayout.setHorizontalGroup(
            DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoVendedorLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(DialogoVendedorLayout.createSequentialGroup()
                        .addGroup(DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel4)
                            .addComponent(jLabel6))
                        .addGap(29, 29, 29)
                        .addGroup(DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jtf_nome, javax.swing.GroupLayout.PREFERRED_SIZE, 205, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(DialogoVendedorLayout.createSequentialGroup()
                                .addComponent(jtf_codigoVendedor, javax.swing.GroupLayout.PREFERRED_SIZE, 137, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(jtf_ativo)))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 503, Short.MAX_VALUE)
                    .addGroup(DialogoVendedorLayout.createSequentialGroup()
                        .addComponent(jtb_save)
                        .addGap(30, 30, 30)
                        .addComponent(jtb_insert)
                        .addGap(29, 29, 29)
                        .addComponent(jtb_update)
                        .addGap(28, 28, 28)
                        .addComponent(jtb_delete)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jtb_close)))
                .addContainerGap())
            .addGroup(DialogoVendedorLayout.createSequentialGroup()
                .addGap(95, 95, 95)
                .addComponent(jLbIcone1, javax.swing.GroupLayout.PREFERRED_SIZE, 296, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        DialogoVendedorLayout.setVerticalGroup(
            DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, DialogoVendedorLayout.createSequentialGroup()
                .addComponent(jLbIcone1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jtf_codigoVendedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel4)
                    .addComponent(jtf_ativo))
                .addGap(18, 18, 18)
                .addGroup(DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jtf_nome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 146, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addGroup(DialogoVendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jtb_save)
                    .addComponent(jtb_delete)
                    .addComponent(jtb_update)
                    .addComponent(jtb_close)
                    .addComponent(jtb_insert))
                .addContainerGap(54, Short.MAX_VALUE))
        );

        DialogoVendedor.getAccessibleContext().setAccessibleName("Hoken Visitas: Imprimir");

        DialogoRelatorio.setMinimumSize(new java.awt.Dimension(468, 400));
        DialogoRelatorio.setResizable(false);

        jLbIcone2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLbIcone2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/visitas/hoken/imagens/hoken.jpeg"))); // NOI18N
        jLbIcone2.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        jLbIcone2.setAlignmentX(0.5F);
        jLbIcone2.setMaximumSize(new java.awt.Dimension(33000, 33000));
        jLbIcone2.setMinimumSize(new java.awt.Dimension(300, 78));
        jLbIcone2.setName("jLabelPrincipal"); // NOI18N
        jLbIcone2.setPreferredSize(new java.awt.Dimension(800, 80));

        jButton1.setText("Imprimir");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setText("Cancelar");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jLabel7.setText("Data de");

        jLabel8.setText("Data ate");

        jLabel9.setText("Cancelados");

        jLabel10.setText("Vendidos");

        jLabel11.setText("Vendedor");

        jcb_vendedoresrelatorio.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        jcb_vendedoresrelatorio.removeAllItems();
        jcb_vendedoresrelatorio.addItem("");
        List<visitas.hoken.modelos.Vendedor> vendp1 = control.Vendedores();
        for (visitas.hoken.modelos.Vendedor v : vendp1) {
            jcb_vendedoresrelatorio.addItem(v.getNomeVendedor());
        }
        jcb_vendedoresrelatorio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jcb_vendedoresrelatorioActionPerformed(evt);
            }
        });

        jcb_canceladosrelatorio.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        jcb_canceladosrelatorio.removeAllItems();
        jcb_canceladosrelatorio.addItem("");
        jcb_canceladosrelatorio.addItem("Sim");
        jcb_canceladosrelatorio.addItem("Não");

        jcb_vendidorelatorio.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        jcb_vendidorelatorio.removeAllItems();
        jcb_vendidorelatorio.addItem("");
        jcb_vendidorelatorio.addItem("Sim");
        jcb_vendidorelatorio.addItem("Não");

        jdc_datade.setToolTipText("Escolha a data da visita");
        jdc_datade.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jdc_datade.setMinimumSize(new java.awt.Dimension(30, 30));
        jdc_datade.setNextFocusableComponent(jtfSemana);
        jdc_datade.setPreferredSize(new java.awt.Dimension(6, 21));
        jdc_Data_Acao();
        jtfSemana.requestFocus();

        jdc_dataate.setToolTipText("Escolha a data da visita");
        jdc_dataate.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jdc_dataate.setMinimumSize(new java.awt.Dimension(30, 30));
        jdc_dataate.setNextFocusableComponent(jtfSemana);
        jdc_dataate.setPreferredSize(new java.awt.Dimension(6, 21));
        jdc_Data_Acao();
        jtfSemana.requestFocus();

        javax.swing.GroupLayout DialogoRelatorioLayout = new javax.swing.GroupLayout(DialogoRelatorio.getContentPane());
        DialogoRelatorio.getContentPane().setLayout(DialogoRelatorioLayout);
        DialogoRelatorioLayout.setHorizontalGroup(
            DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoRelatorioLayout.createSequentialGroup()
                .addGap(82, 82, 82)
                .addComponent(jLbIcone2, javax.swing.GroupLayout.PREFERRED_SIZE, 296, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(90, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, DialogoRelatorioLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(DialogoRelatorioLayout.createSequentialGroup()
                        .addComponent(jButton1)
                        .addGap(18, 18, 18)
                        .addComponent(jButton2))
                    .addGroup(DialogoRelatorioLayout.createSequentialGroup()
                        .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel8)
                            .addComponent(jLabel9)
                            .addComponent(jLabel10)
                            .addComponent(jLabel7))
                        .addGap(18, 18, 18)
                        .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jcb_canceladosrelatorio, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jcb_vendidorelatorio, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jdc_datade, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jdc_dataate, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(DialogoRelatorioLayout.createSequentialGroup()
                        .addComponent(jLabel11)
                        .addGap(27, 27, 27)
                        .addComponent(jcb_vendedoresrelatorio, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(102, 102, 102))
        );
        DialogoRelatorioLayout.setVerticalGroup(
            DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(DialogoRelatorioLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLbIcone2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel7)
                    .addComponent(jdc_datade, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel8)
                    .addComponent(jdc_dataate, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jcb_canceladosrelatorio, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(DialogoRelatorioLayout.createSequentialGroup()
                        .addGap(9, 9, 9)
                        .addComponent(jLabel9)))
                .addGap(18, 18, 18)
                .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel10)
                    .addComponent(jcb_vendidorelatorio, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(jcb_vendedoresrelatorio, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 47, Short.MAX_VALUE)
                .addGroup(DialogoRelatorioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton1)
                    .addComponent(jButton2))
                .addGap(37, 37, 37))
        );

        DialogoRelatorio.getAccessibleContext().setAccessibleDescription("");
        DialogoRelatorio.getAccessibleContext().setAccessibleParent(null);

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Hoken Visitas: Gerenciamento");
        setBackground(new java.awt.Color(255, 255, 255));
        setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        setForeground(new java.awt.Color(255, 204, 204));
        setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/visitas/hoken/imagens/h.jpeg")));
        setMinimumSize(new java.awt.Dimension(800, 600));
        setName("jFVisita"); // NOI18N
        setResizable(false);
        setSize(new java.awt.Dimension(600, 293));

        Hoken.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        Hoken.setIcon(new javax.swing.ImageIcon(getClass().getResource("/visitas/hoken/imagens/hokentubnaill.png"))); // NOI18N

        jMenu_Arquivo.setMnemonic('A');
        jMenu_Arquivo.setText("Arquivo");
        jMenu_Arquivo.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jMenu_Arquivo.setMargin(new java.awt.Insets(5, 5, 5, 5));

        jmi_Backup.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_B, java.awt.event.InputEvent.CTRL_MASK));
        jmi_Backup.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jmi_Backup.setText("Backup");
        jmi_Backup.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_BackupActionPerformed(evt);
            }
        });
        jMenu_Arquivo.add(jmi_Backup);

        jmi_Sair.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_F4, 0));
        jmi_Sair.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jmi_Sair.setText("Sair");
        jmi_Sair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_SairActionPerformed(evt);
            }
        });
        jMenu_Arquivo.add(jmi_Sair);

        BarraDeMenus.add(jMenu_Arquivo);

        jMenu_Vendedores.setMnemonic('N');
        jMenu_Vendedores.setText("Vendedores");
        jMenu_Vendedores.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jMenu_Vendedores.setMargin(new java.awt.Insets(5, 5, 5, 5));

        jMenuItem2.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jMenuItem2.setText("Cadastro");
        jMenuItem2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem2ActionPerformed(evt);
            }
        });
        jMenu_Vendedores.add(jMenuItem2);

        BarraDeMenus.add(jMenu_Vendedores);

        jMenu_Visitas.setMnemonic('V');
        jMenu_Visitas.setText("Visitas");
        jMenu_Visitas.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jMenu_Visitas.setMargin(new java.awt.Insets(5, 5, 5, 5));

        jmi_NovaVisita.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_N, java.awt.event.InputEvent.CTRL_MASK));
        jmi_NovaVisita.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jmi_NovaVisita.setText("Nova Visita");
        jmi_NovaVisita.setMargin(new java.awt.Insets(5, 5, 5, 5));
        jmi_NovaVisita.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_NovaVisitaActionPerformed(evt);
            }
        });
        jMenu_Visitas.add(jmi_NovaVisita);

        jmi_AlterarVisita.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_A, java.awt.event.InputEvent.CTRL_MASK));
        jmi_AlterarVisita.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jmi_AlterarVisita.setText("Alterar Visita");
        jmi_AlterarVisita.setMargin(new java.awt.Insets(5, 5, 5, 5));
        jmi_AlterarVisita.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_AlterarVisitaActionPerformed(evt);
            }
        });
        jMenu_Visitas.add(jmi_AlterarVisita);

        jmi_listavisitas.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jmi_listavisitas.setText("Lista Visitas");
        jmi_listavisitas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_listavisitasActionPerformed(evt);
            }
        });
        jMenu_Visitas.add(jmi_listavisitas);
        jMenu_Visitas.add(jSeparator4);

        BarraDeMenus.add(jMenu_Visitas);

        jMenu_Relatorios.setMnemonic('R');
        jMenu_Relatorios.setText("Relatórios");
        jMenu_Relatorios.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jMenu_Relatorios.setMargin(new java.awt.Insets(5, 5, 5, 5));

        jmi_todasvisitas.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jmi_todasvisitas.setText("Visitas");
        jmi_todasvisitas.setToolTipText("");
        jmi_todasvisitas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jmi_todasvisitasActionPerformed(evt);
            }
        });
        jMenu_Relatorios.add(jmi_todasvisitas);

        BarraDeMenus.add(jMenu_Relatorios);

        jMenu_Sobre.setMnemonic('S');
        jMenu_Sobre.setText("Sobre");
        jMenu_Sobre.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jMenu_Sobre.setMargin(new java.awt.Insets(5, 5, 5, 5));
        jMenu_Sobre.addMenuListener(new javax.swing.event.MenuListener() {
            public void menuCanceled(javax.swing.event.MenuEvent evt) {
            }
            public void menuDeselected(javax.swing.event.MenuEvent evt) {
            }
            public void menuSelected(javax.swing.event.MenuEvent evt) {
                jMenu_SobreMenuSelected(evt);
            }
        });
        jMenu_Sobre.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jMenu_SobreMouseClicked(evt);
            }
        });
        jMenu_Sobre.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenu_SobreActionPerformed(evt);
            }
        });
        BarraDeMenus.add(jMenu_Sobre);

        setJMenuBar(BarraDeMenus);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(Hoken, javax.swing.GroupLayout.DEFAULT_SIZE, 776, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(187, 187, 187)
                .addComponent(Hoken, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(218, Short.MAX_VALUE))
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void jdc_Data_Acao() {
        try {
            jdc_Data.addPropertyChangeListener(new PropertyChangeListener() {
                @Override
                public void propertyChange(PropertyChangeEvent evt) {
                    if (evt.getPropertyName() == "date") {
                        //data no formato string
                        data1 = evt.getNewValue().toString();
                        //data no formato date
                        data2 = jdc_Data.getDate();
                        DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
                        try {
                            data2 = new java.sql.Date(df.parse(df.format(jdc_Data.getDate())).getTime());
                        } catch (ParseException ex) {
                            Logger.getLogger(JanelaVisitas.class.getName()).log(Level.SEVERE, null, ex);
                        }
                        GregorianCalendar gc = new GregorianCalendar();
                        gc.setTime(data2);
                        int diaDaSemana = gc.get(GregorianCalendar.DAY_OF_WEEK);
                        jtfSemana.setText(u.converteSemana(diaDaSemana));
                        diaSemana = u.converteSemana(diaDaSemana);
                    }
                }
            });
        } catch (Exception e) {
            jp.showMessageDialog(DialogoNovaVisita, "Erro com a Data! "
                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
            System.err.println("\n============================================");
            System.err.println("\nCLASSE JANELA VISITAS");
            System.err.println("\nERRO NO jdc_Data_Acao");
            System.err.println("\nCAUSA: " + e.getCause());
            System.err.println("\nMENSAGEM " + e.getMessage());
            e.printStackTrace();
            System.err.println("\n============================================");
        }

    }

    private void jmi_NovaVisitaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_NovaVisitaActionPerformed
        try {
            DialogoNovaVisita.setLocationRelativeTo(null);
            DialogoNovaVisita.setModal(true);
            DialogoNovaVisita.setVisible(true);
        } catch (Exception e) {
            jp.showMessageDialog(DialogoNovaVisita, "Erro ao abrir a Janela! "
                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
            System.err.println("\n============================================");
            System.err.println("\nCLASSE JANELA VISITAS");
            System.err.println("\nERRO NO jmi_NovaVisitaActionPerformed");
            System.err.println("\nCAUSA: " + e.getCause());
            System.err.println("\nMENSAGEM " + e.getMessage());
            e.printStackTrace();
            System.err.println("\n============================================");
        }
    }//GEN-LAST:event_jmi_NovaVisitaActionPerformed

    private void jmi_AlterarVisitaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_AlterarVisitaActionPerformed
        try {
            jl_AlterarVisita.setVisible(false);
            //jb_SalvarChange.setVisible(false);
            //jb_CancelarChange.setVisible(false);
            DialogoAlteraVisita.setLocationRelativeTo(null);
            DialogoAlteraVisita.setModal(true);
            DialogoAlteraVisita.setVisible(true);
        } catch (Exception e) {
            jp.showMessageDialog(DialogoAlteraVisita, "Erro ao abrir a Janela! "
                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
            System.err.println("\n============================================");
            System.err.println("\nCLASSE JANELA VISITAS");
            System.err.println("\nERRO NO jmi_NovaVisitaActionPerformed");
            System.err.println("\nCAUSA: " + e.getCause());
            System.err.println("\nMENSAGEM " + e.getMessage());
            e.printStackTrace();
            System.err.println("\n============================================");
        }
    }//GEN-LAST:event_jmi_AlterarVisitaActionPerformed

    private void jftCEPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jftCEPActionPerformed
        buscaCEP busca = new buscaCEP();
        CEP = jftCEP.getText();
        try {
            jtfEndereco.setText(busca.getEndereco(CEP));
            jtfBairro.setText(busca.getBairro(CEP));
            jtfCidade.setText(busca.getCidade(CEP));
            jtfEstado.setText(busca.getUF(CEP));
        } catch (IOException e) {
            jp.showMessageDialog(DialogoNovaVisita, "Erro ao procurar CEP! "
                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
            System.err.println("\n============================================");
            System.err.println("\nCLASSE JANELA VISITAS");
            System.err.println("\nERRO NO jftCEPActionPerformed");
            System.err.println("\nCAUSA: " + e.getCause());
            System.err.println("\nMENSAGEM " + e.getMessage());
            e.printStackTrace();
            System.err.println("\n============================================");
        }
    }//GEN-LAST:event_jftCEPActionPerformed

    private void jtfComplementoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfComplementoActionPerformed

    }//GEN-LAST:event_jtfComplementoActionPerformed

    private void jftfCelularActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jftfCelularActionPerformed

    }//GEN-LAST:event_jftfCelularActionPerformed

    private void jbCadastrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbCadastrarActionPerformed
        hora = jfHora.getText();
        try {
            SimpleDateFormat formatador = new SimpleDateFormat("HH:mm");
            Date data = formatador.parse(hora);
            time = new Time(data.getTime());
        } catch (Exception e) {
            jp.showMessageDialog(DialogoNovaVisita, "Erro com a hora! "
                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
            System.err.println("\n============================================");
            System.err.println("\nCLASSE JANELAS VISITAS");
            System.err.println("\nERRO NO jbCadastrarActionPerformed");
            System.err.println("\nCAUSA: " + e.getCause());
            System.err.println("\nMENSAGEM " + e.getMessage());
            e.printStackTrace();
            System.err.println("\n============================================");
        }

        visita.setNome(jtfNome.getText());
        visita.setEndereco(jtfEndereco.getText());
        visita.setComplemento(jtfComplemento.getText());
        visita.setBairro(jtfBairro.getText());
        visita.setCep(jftCEP.getText());
        visita.setCidade(jtfCidade.getText());
        visita.setEstado(jtfEstado.getText());
        visita.setTelefoneFixo(jftfFixo.getText());
        visita.setTelefoneCelular(jftfCelular.getText());
        visita.setTelefoneRecado(jftfRecado.getText());
        visita.setData(data2);
        visita.setHora(time);
        visita.setDiaSemana(diaSemana);
        visita.setIndicacao(jtfIndicacao.getText());
        visita.setVendedor1(jcb_VendPrin.getSelectedItem().toString());
        visita.setVendedor2(jcb_VendSe.getSelectedItem().toString());
        visita.setVendeu(false);
        visita.setCancelada(false);
        visita.setObservacoes(jta_observacao.getText());

        try {
            control.InsereVisita(visita);
            jp.showMessageDialog(DialogoNovaVisita, "Visita Cadastrada com Sucesso!", "OK", jp.INFORMATION_MESSAGE, salvo);
            DialogoNovaVisita.setVisible(false);
            //imprimeV = new ImprimirVisita(visita);
            //JOptionPane.showMessageDialog(DialogoNovaVisita, "PDF criado com sucesso!");
            //Desktop.getDesktop().open(new File("C:\\Users\\Public\\Visita.pdf"));
        } catch (Exception e) {
            jp.showMessageDialog(DialogoNovaVisita, "Erro ao Cadastrar Visita!"
                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
            System.err.println("\n============================================");
            System.err.println("\nCLASSE JANELA VISITAS");
            System.err.println("\nERRO NO jbCadastrarActionPerformed");
            System.err.println("\nCAUSA: " + e.getCause());
            System.err.println("\nMENSAGEM " + e.getMessage());
            e.printStackTrace();
            System.err.println("\n============================================");
        }
        DialogoNovaVisita.setVisible(false);
    }//GEN-LAST:event_jbCadastrarActionPerformed

    private void jtfSemanaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfSemanaActionPerformed

    }//GEN-LAST:event_jtfSemanaActionPerformed

    private void jcb_VendSeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jcb_VendSeActionPerformed

    }//GEN-LAST:event_jcb_VendSeActionPerformed

    private void jtfNomeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfNomeActionPerformed

    }//GEN-LAST:event_jtfNomeActionPerformed

    private void jfHoraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jfHoraActionPerformed

    }//GEN-LAST:event_jfHoraActionPerformed

    private void jtfIndicacaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfIndicacaoActionPerformed

    }//GEN-LAST:event_jtfIndicacaoActionPerformed

    private void jtfEnderecoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfEnderecoActionPerformed

    }//GEN-LAST:event_jtfEnderecoActionPerformed

    private void jtfBairroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfBairroActionPerformed

    }//GEN-LAST:event_jtfBairroActionPerformed

    private void jtfCidadeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfCidadeActionPerformed

    }//GEN-LAST:event_jtfCidadeActionPerformed

    private void jtfEstadoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtfEstadoActionPerformed

    }//GEN-LAST:event_jtfEstadoActionPerformed

    private void jftfFixoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jftfFixoActionPerformed

    }//GEN-LAST:event_jftfFixoActionPerformed

    private void jftfRecadoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jftfRecadoActionPerformed

    }//GEN-LAST:event_jftfRecadoActionPerformed

    private void jtf_AlterarVisitaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtf_AlterarVisitaActionPerformed

    }//GEN-LAST:event_jtf_AlterarVisitaActionPerformed

    private void jtf_AlterarVisitaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jtf_AlterarVisitaKeyPressed

    }//GEN-LAST:event_jtf_AlterarVisitaKeyPressed

    private void jb_VisitaAlterarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_VisitaAlterarActionPerformed
        String name = "";
        if (jtf_AlterarVisita.getText().trim().equals("")) {
            jp.showMessageDialog(DialogoAlteraVisita, "Campo Vazio! Digite um nome", "ATENÇÃO!", jp.WARNING_MESSAGE);
            name = "";
            jtf_AlterarVisita.setText("");
        } else {
            try {
                name = jtf_AlterarVisita.getText();
                vis = control.getVisitaNome1(name);
                if (vis.isEmpty()) {
                    jp.showMessageDialog(DialogoAlteraVisita, "Nome não encontrado", "ATENÇÃO!", jp.WARNING_MESSAGE);
                    name = "";
                    jtf_AlterarVisita.setText("");
                    lista.removeAllElements();
                } else {
                    jtp_1.setSelectedIndex(0);
                    lista.removeAllElements();
                    for (Visitas v : vis) {
                        lista.addElement(v.getNome());
                        vis2 = vis;
                        visita2 = v;
                    }
                    jtp_1.setVisible(true);
                    jl_AlterarVisita.setModel(lista);
                    jl_AlterarVisita.setVisible(true);
                    jtf_AlterarVisita.setText("");
                }
            } catch (Exception e) {
                jp.showMessageDialog(DialogoAlteraVisita, "ERRO AO BUSCAR NOME! "
                        + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
                System.err.println("\n============================================");
                System.err.println("\nCLASSE JANELA VISITAS");
                System.err.println("\nERRO NO MÉTODO jb_VisitaAlterarActionPerformed");
                System.err.println("\nCAUSA: " + e.getCause());
                System.err.println("\nMENSAGEM " + e.getMessage());
                e.printStackTrace();
                System.err.println("\n============================================");
                name = "";
                jtf_AlterarVisita.setText("");
                lista.removeAllElements();
            }
        }
    }//GEN-LAST:event_jb_VisitaAlterarActionPerformed

    private void jl_AlterarVisitaValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_jl_AlterarVisitaValueChanged
        if (!evt.getValueIsAdjusting() && jl_AlterarVisita.getSelectedValue() != null) {
            String text = jl_AlterarVisita.getSelectedValue().toString();
            System.out.println("Elemento selecionado: " + text);
            idx = jl_AlterarVisita.getSelectedIndex();
            System.out.println("Elemento selecionado: " + idx);
            if (jl_AlterarVisita.getSelectedIndex() != -1) {
                for (Visitas v : vis2) {
                    if (v.getNome().equals(text)) {
                        try {
                            DateFormat df = new SimpleDateFormat("dd/MM/yyyy");
                            jTable_Alterar.setModel(new javax.swing.table.DefaultTableModel(
                                    new Object[][]{
                                        {"Código", v.getCodigoVisita()},
                                        {"Nome", v.getNome()},
                                        {"Endereço", v.getEndereco()},
                                        {"Complemento", v.getComplemento()},
                                        {"Bairro", v.getBairro()},
                                        {"CEP", v.getCep()},
                                        {"Cidade", v.getCidade()},
                                        {"Estado", v.getEstado()},
                                        {"Telefone Fixo", v.getTelefoneFixo()},
                                        {"Telefone Celular", v.getTelefoneCelular()},
                                        {"Telefone para Recado", v.getTelefoneRecado()},
                                        {"Data", df.format(v.getData())},
                                        {"Hora", v.getHora()},
                                        {"Dia da Semana", v.getDiaSemana()},
                                        {"Indicação", v.getIndicacao()},
                                        {"Vendedor 1", v.getVendedor1()},
                                        {"Vendedor 2", v.getVendedor2()},
                                        {"Vendeu? [1 - Sim, 0 - Não] ", v.isVendeu()},
                                        {"Cancelou? [1 - Sim, 0 - Não] ", v.isCancelada()},
                                        {"Observações", v.getObservacoes()},},
                                    new String[]{
                                        "Campos", "Conteúdos"
                                    }
                            ));
                            jtp_1.setSelectedIndex(1);
                            //jb_SalvarChange.setVisible(true);
                            //jb_CancelarChange.setVisible(true);
                            codigo = v.getCodigoVisita();

                        } catch (Exception e) {
                            jp.showMessageDialog(DialogoAlteraVisita, "ERRO AO BUSCAR NOME!"
                                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
                            System.err.println("\n============================================");
                            System.err.println("\nCLASSE JANELA VISITAS");
                            System.err.println("\nERRO NO jl_AlterarVisitaValueChanged");
                            System.err.println("\nCAUSA: " + e.getCause());
                            System.err.println("\nMENSAGEM " + e.getMessage());
                            e.printStackTrace();
                            System.err.println("\n============================================");
                        }
                    }
                }
            }
        }
    }//GEN-LAST:event_jl_AlterarVisitaValueChanged

    private void jb_SalvarChangeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_SalvarChangeActionPerformed
        try {
            visita.setCodigoVisita(codigo);
            visita.setNome(jTable_Alterar.getValueAt(1, 1).toString());
            visita.setEndereco(jTable_Alterar.getValueAt(2, 1).toString());
            visita.setComplemento(jTable_Alterar.getValueAt(3, 1).toString());
            visita.setBairro(jTable_Alterar.getValueAt(4, 1).toString());
            visita.setCep(jTable_Alterar.getValueAt(5, 1).toString());
            visita.setCidade(jTable_Alterar.getValueAt(6, 1).toString());
            visita.setEstado(jTable_Alterar.getValueAt(7, 1).toString());
            visita.setTelefoneFixo(jTable_Alterar.getValueAt(8, 1).toString());
            visita.setTelefoneCelular(jTable_Alterar.getValueAt(9, 1).toString());
            visita.setTelefoneRecado(jTable_Alterar.getValueAt(10, 1).toString());

            String d1 = jTable_Alterar.getValueAt(11, 1).toString();
            visita.setData(u.converteStringDate(d1));

            String h1 = jTable_Alterar.getValueAt(12, 1).toString();
            visita.setHora(u.converteTimeEmString(h1));

            visita.setDiaSemana(jTable_Alterar.getValueAt(13, 1).toString());
            visita.setIndicacao(jTable_Alterar.getValueAt(14, 1).toString());
            visita.setVendedor1(jTable_Alterar.getValueAt(15, 1).toString());
            visita.setVendedor2(jTable_Alterar.getValueAt(16, 1).toString());

            String vendeu = jTable_Alterar.getValueAt(17, 1).toString();
            if (vendeu.equals("1")) {
                visita.setVendeu(true);
            } else {
                visita.setVendeu(false);
            }

            String cancelou = jTable_Alterar.getValueAt(18, 1).toString();
            if (cancelou.equals("1")) {
                visita.setVendeu(true);
            } else {
                visita.setVendeu(false);
            }

            visita.setObservacoes(jTable_Alterar.getValueAt(19, 1).toString());
            control.AlteraVisita(visita);
            jp.showMessageDialog(DialogoAlteraVisita, "Alterações cadastradas com sucesso!", "SUCESSO!", jp.INFORMATION_MESSAGE);
            
            int response = jp.showConfirmDialog(DialogoAlteraVisita, "Imprimir Visita?", "IMPRESSÃO", jp.YES_NO_OPTION, jp.QUESTION_MESSAGE, impressao);
            switch (response) {
                case JOptionPane.YES_OPTION:
                 
                    //Sempre usando o filechooser
                    JFileChooser filechooser = new JFileChooser();
                    filechooser.showSaveDialog(DialogoAlteraVisita);
                    
                    //Passa os parametros
                    Map parameters = new HashMap();
                    parameters.put("codigoVisita", codigo);
                   
                    //Chama o relatório
                    RelatoriosJasper jasper = new RelatoriosJasper(EnumRelatorios.PrincipalVisitaAgendada, filechooser.getSelectedFile().getAbsolutePath());
                    jasper.setParameters(parameters);
                    jasper.setView(true);
                    
                    //fecha janela
                    DialogoAlteraVisita.setVisible(false);
                    
                    //imprimir relatório
                    jasper.imprimir();
                    
                    break;
                case JOptionPane.NO_OPTION:
                    jtp_1.setSelectedIndex(0);
                    break;
            }
            
        } catch (Exception e) {
            jp.showMessageDialog(DialogoAlteraVisita, "ERRO! "
                    + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
            System.err.println("\n============================================");
            System.err.println("\nCLASSE JANELA VISITAS");
            System.err.println("\nERRO NO MÉTODO jb_SalvarChangeActionPerformed");
            System.err.println("\nCAUSA: " + e.getCause());
            System.err.println("\nMENSAGEM " + e.getMessage());
            e.printStackTrace();
            System.err.println("\n============================================");
        }
        jtp_1.setSelectedIndex(0);
    }//GEN-LAST:event_jb_SalvarChangeActionPerformed

    private void jl_AlterarVisitaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jl_AlterarVisitaMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_jl_AlterarVisitaMouseClicked

    private void jb_CancelarChangeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_CancelarChangeActionPerformed
        jTable_Alterar.setModel(new javax.swing.table.DefaultTableModel(
                new Object[][]{
                    {"Código", ""},
                    {"Nome", ""},
                    {"Endereço", ""},
                    {"Complemento", ""},
                    {"Bairro", ""},
                    {"CEP", ""},
                    {"Cidade", ""},
                    {"Estado", ""},
                    {"Telefone Fixo", ""},
                    {"Telefone Celular", ""},
                    {"Telefone para Recado", ""},
                    {"Data", ""},
                    {"Hora", ""},
                    {"Dia da Semana", ""},
                    {"Indicação", ""},
                    {"Vendedor 1", ""},
                    {"Vendedor 2", ""},
                    {"Vendeu? [1 - Sim, 0 - Não] ", ""},
                    {"Cancelou? [1 - Sim, 0 - Não] ", ""},
                    {"Observações", ""},},
                new String[]{
                    "Campos", "Conteúdos"
                }
        ));
        lista.removeAllElements();
        jtp_1.setSelectedIndex(0);
    }//GEN-LAST:event_jb_CancelarChangeActionPerformed

    private void jMenu_SobreActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenu_SobreActionPerformed

    }//GEN-LAST:event_jMenu_SobreActionPerformed

    private void jMenu_SobreMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jMenu_SobreMouseClicked
        jp.showMessageDialog(jMenu_Sobre, "Este software foi desenvolvido por Elaine Cecília Gatto. "
                + "\n Hoken Visitas. Versão Beta 0.0.1 de 01/2018"
                + "\n Contato: 14-9-9102-6306", "SOBRE", jp.INFORMATION_MESSAGE);
    }//GEN-LAST:event_jMenu_SobreMouseClicked

    private void jMenu_SobreMenuSelected(javax.swing.event.MenuEvent evt) {//GEN-FIRST:event_jMenu_SobreMenuSelected
        jp.showMessageDialog(jMenu_Sobre, "Este software foi desenvolvido por Elaine Cecília Gatto. "
                + "\n Hoken Visitas Versão Beta 0.0.1 de 01/2018"
                + "\n Contato: 14-9-9102-6306", "SOBRE", jp.INFORMATION_MESSAGE);
    }//GEN-LAST:event_jMenu_SobreMenuSelected

    private void jmi_BackupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_BackupActionPerformed
        MySQLBackup backup = new MySQLBackup();
        String retorno = backup.executar();
        jp.showMessageDialog(DialogoImprimir, retorno, "Backup", jp.INFORMATION_MESSAGE);
    }//GEN-LAST:event_jmi_BackupActionPerformed

    private void jmi_SairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_SairActionPerformed
        // TODO add your handling code here:
        System.exit(0);
    }//GEN-LAST:event_jmi_SairActionPerformed

    private void jMenuItem2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem2ActionPerformed
       DialogoVendedor.setVisible(true);
    }//GEN-LAST:event_jMenuItem2ActionPerformed

    private void jmi_todasvisitasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_todasvisitasActionPerformed
       DialogoRelatorio.setVisible(true);
    }//GEN-LAST:event_jmi_todasvisitasActionPerformed

    private void jtb_vendedorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_vendedorActionPerformed

        DialogoVendedor.setVisible(true);
    }//GEN-LAST:event_jtb_vendedorActionPerformed

    private void jmi_listavisitasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jmi_listavisitasActionPerformed
        //jTable_Imprimir.setModel(visitasTableModel);
        this.DialogoImprimir.setVisible(true);
    }//GEN-LAST:event_jmi_listavisitasActionPerformed

    private void jtb_fecharActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_fecharActionPerformed
        DialogoImprimir.setVisible(false);
    }//GEN-LAST:event_jtb_fecharActionPerformed

    private void jtb_imprimirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_imprimirActionPerformed

        //Valida se código é maior que zero
        if(codigoRelatorio <= 0){
            JOptionPane.showMessageDialog(DialogoImprimir, "Código não selecionado");
            return;
        }

        //Chama FileChooser
        JFileChooser file = new JFileChooser();
        file.showSaveDialog(DialogoImprimir);

        RelatoriosJasper jasper = new RelatoriosJasper(EnumRelatorios.PrincipalVisitaAgendada, file.getSelectedFile().getAbsolutePath());
        
        Map parameters = new HashMap();
        parameters.put("codigoVisita", codigoRelatorio);
        jasper.setParameters(parameters);
        jasper.setView(true);
        
        DialogoImprimir.setVisible(false);
        
        try {
            jasper.imprimir();
        } catch (JRException e) {
            System.out.println(e);
        } catch (SQLException ex) {
            Logger.getLogger(JanelaVisitas.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_jtb_imprimirActionPerformed

    private void jtb_buscarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_buscarActionPerformed
        
        //visitasTableModel.searchRow(jtf_BuscarNomeImprimir.getText());
        sorter.setRowFilter(RowFilter.regexFilter(jtf_BuscarNomeImprimir.getText(), 1));
        jtable_visitas.setRowSorter(sorter);
        
    }//GEN-LAST:event_jtb_buscarActionPerformed

    private void jtable_visitasMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jtable_visitasMouseClicked
        this.codigoRelatorio = (int) jtable_visitas.getValueAt(jtable_visitas.getSelectedRow(), 0);

        //this.jtf_codigoVisita.setText(codigoRelatorio + "");
        //JOptionPane.showMessageDialog(DialogoImprimir, jtable_visitas.getValueAt(jtable_visitas.getSelectedRow(), 0));
    }//GEN-LAST:event_jtable_visitasMouseClicked

    private void jtf_BuscarNomeImprimirKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jtf_BuscarNomeImprimirKeyPressed
        modelo.setRowCount(0);
        List<Visitas> vis1 = new ArrayList<Visitas>();
        jTable_Imprimir.setVisible(false);
        String name = "";
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            if (jtf_BuscarNomeImprimir.getText().trim().equals("")) {
                jp.showMessageDialog(DialogoImprimir, "Campo Vazio! Digite um nome", "ATENÇÃO!", jp.WARNING_MESSAGE);
                name = "";
                jtf_BuscarNomeImprimir.setText("");
                jTable_Imprimir.setVisible(false);
            } else {
                try {
                    name = jtf_BuscarNomeImprimir.getText();
                    vis1 = control.getVisitaNome1(name);
                    if (vis1.isEmpty()) {
                        jp.showMessageDialog(DialogoImprimir, "Nome não encontrado", "ATENÇÃO!", jp.WARNING_MESSAGE);
                        name = "";
                        jtf_BuscarNomeImprimir.setText("");
                        jTable_Imprimir.setVisible(false);
                        vis1.clear();
                    } else {
                        modelo.setColumnIdentifiers(new String[]{"Código", "Nome", "Data", "Hora"});
                        for (int i = 0; i < vis1.size(); i++) {
                            modelo.addRow(new String[]{String.valueOf(vis1.get(i).getCodigoVisita()), vis1.get(i).getNome(), vis1.get(i).getData().toString(), vis1.get(i).getHora().toString()});
                        }
                        for (Visitas v : vis) {
                            vis2 = vis;
                            visita2 = v;
                        }
                        jTable_Imprimir.setRowSelectionAllowed(true);
                        jTable_Imprimir.setColumnSelectionAllowed(false);
                        jTable_Imprimir.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
                        jTable_Imprimir.setModel(modelo);
                        jTable_Imprimir.setVisible(true);
                        jtf_BuscarNomeImprimir.setText("");
                    }
                    name = "";
                    jtf_BuscarNomeImprimir.setText("");
                    vis1.clear();
                } catch (Exception e) {
                    jp.showMessageDialog(DialogoImprimir, "ERRO AO BUSCAR NOME! "
                        + "\n Causa: " + e.getCause(), "ERRO", jp.ERROR_MESSAGE, erro);
                    System.err.println("\n============================================");
                    System.err.println("\nCLASSE JANELA VISITAS");
                    System.err.println("\nERRO NO MÉTODO jtf_BuscarNomeImprimirKeyPressed");
                    System.err.println("\nCAUSA: " + e.getCause());
                    System.err.println("\nMENSAGEM " + e.getMessage());
                    e.printStackTrace();
                    System.err.println("\n============================================");
                    name = "";
                    jtf_BuscarNomeImprimir.setText("");
                    jTable_Imprimir.setVisible(false);
                    vis1.clear();
                }
            }
        }
        vis1.clear();
    }//GEN-LAST:event_jtf_BuscarNomeImprimirKeyPressed

    private void jtf_BuscarNomeImprimirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtf_BuscarNomeImprimirActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jtf_BuscarNomeImprimirActionPerformed

    private void jtb_insertActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_insertActionPerformed

        this.enableForms();
        this.cleanForms();

        //troca de false para true
        this.inserir = true;
    }//GEN-LAST:event_jtb_insertActionPerformed

    private void jtb_closeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_closeActionPerformed
        DialogoVendedor.setVisible(false);

        if(DialogoNovaVisita.isVisible()){
            jcb_VendPrin.removeAllItems();
            jcb_VendSe.removeAllItems();

            jcb_VendPrin.addItem("");
            jcb_VendSe.addItem("");

            List<visitas.hoken.modelos.Vendedor> vendp = control.Vendedores();
            for (visitas.hoken.modelos.Vendedor v : vendp) {
                jcb_VendPrin.addItem(v.getNomeVendedor());
                jcb_VendSe.addItem(v.getNomeVendedor());
            }

        }

    }//GEN-LAST:event_jtb_closeActionPerformed

    private void jtb_updateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_updateActionPerformed
        this.enableForms();
        this.jtf_codigoVendedor.setEnabled(false);

        if(this.inserir){
            JOptionPane.showMessageDialog(DialogoVendedor, "Selecione primeiro uma linha");
        }
        else {
            this.inserir = false;
        }
    }//GEN-LAST:event_jtb_updateActionPerformed

    private void jtb_deleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_deleteActionPerformed

        //0,1,2
        if(JOptionPane.showConfirmDialog(DialogoVendedor, "Deseja excluir vendedor?") != 0){
            return;
        }

        //Model
        Vendedor vend1 = new Vendedor();

        //dao
        VendedorDao venddao = new VendedorDao();
        int codigoVendedor1 = Integer.parseInt(jTable_Imprimir.getModel().getValueAt(jTable_Imprimir.getSelectedRow(), 0).toString());

        //regra
        vend1.setCodigoVendedor(codigoVendedor1);
        if(venddao.delete(vend1)){
            JOptionPane.showMessageDialog(DialogoVendedor, "Deletado com sucesso");
        }

        //atualiza a planilha

        tableModel.updateRow();
        this.cleanForms();
        this.enableForms();
    }//GEN-LAST:event_jtb_deleteActionPerformed

    private void jtb_saveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_saveActionPerformed

        //Model
        Vendedor vend = new Vendedor();

        //Dao
        VendedorDao venddao = new VendedorDao();

        //seta nome
        //seta Status

        vend.setNomeVendedor(this.jtf_nome.getText());
        vend.setAtivo(this.jtf_ativo.isSelected());
        vend.setCodigoVendedor(Integer.parseInt(this.jtf_codigoVendedor.getText()));

        //logica do inserir
        if(inserir){
            if(venddao.insert(vend)){
                JOptionPane.showMessageDialog(DialogoVendedor, "Salvo com sucesso");
            }
        }else{

            vend.setCodigoVendedor(Integer.parseInt(this.jtf_codigoVendedor.getText()));
            if(venddao.update(vend)){
                JOptionPane.showMessageDialog(DialogoVendedor, "Alterado com sucesso");
            }
        }

        this.cleanForms();
        this.enableForms();
        this.inserir = true;
        tableModel.updateRow();
    }//GEN-LAST:event_jtb_saveActionPerformed

    private void jTable_ImprimirMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable_ImprimirMouseClicked
        // TODO add your handling code here:
        //Object obj = jtable_vendedores.getValueAt(suaJTable.getSelectedRow(),jtable_vendedores);

        String codigoVendedor = jTable_Imprimir.getModel().getValueAt(jTable_Imprimir.getSelectedRow(), 0).toString();
        String nomeVendedor = jTable_Imprimir.getModel().getValueAt(jTable_Imprimir.getSelectedRow(), 1).toString();
        boolean ativo = Boolean.parseBoolean(jTable_Imprimir.getModel().getValueAt(jTable_Imprimir.getSelectedRow(), 2).toString());

        jtf_codigoVendedor.setText(codigoVendedor);
        jtf_nome.setText(nomeVendedor);
        jtf_ativo.setSelected(ativo);

        this.disableForms();
        this.inserir = false;
    }//GEN-LAST:event_jTable_ImprimirMouseClicked

    private void jcb_vendidosKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jcb_vendidosKeyPressed
/*
        String b = "";        
        sorter.setRowFilter(RowFilter.regexFilter(b.valueOf(jcb_vendidos.isSelected()), 5));       
        jtable_visitas.setRowSorter(sorter);
        //sorter.setRowFilter(RowFilter.regexFilter(b.valueOf(jcb_canceladas.isSelected()), 6));
        */
    }//GEN-LAST:event_jcb_vendidosKeyPressed

    private void jcb_vendidosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jcb_vendidosMouseClicked

        String b = "";        
        sorter.setRowFilter(RowFilter.regexFilter(b.valueOf(jcb_vendidos.isSelected()), 5));       
        jtable_visitas.setRowSorter(sorter);
    }//GEN-LAST:event_jcb_vendidosMouseClicked

    private void jcb_canceladasMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jcb_canceladasMouseClicked
        String b = "";        
        sorter.setRowFilter(RowFilter.regexFilter(b.valueOf(jcb_canceladas.isSelected()), 6));       
        jtable_visitas.setRowSorter(sorter);
    }//GEN-LAST:event_jcb_canceladasMouseClicked

    private void jtb_limparfiltroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_limparfiltroActionPerformed
        jtable_visitas.setRowSorter(null);
    }//GEN-LAST:event_jtb_limparfiltroActionPerformed

    private void jcb_vendedoresrelatorioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jcb_vendedoresrelatorioActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jcb_vendedoresrelatorioActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
   
        
        VisitasDAO dao = new VisitasDAO();
        List<Visitas> visitas = dao.getListaVisitas();
        
        
        //parametros
        Map parameters = new HashMap();
        parameters.put("datade", jdc_datade.getDate() );
        parameters.put("dataate", jdc_dataate.getDate());       
        
        String sql = "";
        
        // 0 nada, 1 sim, 2 não
        if(jcb_canceladosrelatorio.getSelectedIndex() > 0){
            sql = " AND cancelada = ";
            
            switch(jcb_canceladosrelatorio.getSelectedIndex()){
                case 1: sql += " 1 "; break;
                case 2: sql += " 0 "; break;
                default: sql += " ";
            }
            
            
            
        }
        
        // 0 nada, 1 sim, 2 não
        if(jcb_vendidorelatorio.getSelectedIndex() > 0){
            sql = " AND vendeu = ";
            
            switch(jcb_vendidorelatorio.getSelectedIndex()){
                case 1: sql += " 1 "; break;
                case 2: sql += " 0 "; break;
                default: sql += " ";
            }
            
        }
        
        parameters.put("sql",sql);
        
        RelatoriosJasper jasper = new RelatoriosJasper(EnumRelatorios.ListaVisitas, "c:\\temp\\teste.pdf");
        jasper.setParameters(parameters);
        jasper.setView(true);
        //jasper.setParameters(parameters);
        

        try {
            jasper.imprimir();
            DialogoRelatorio.setVisible(false);
        } catch (Exception e) {
            
        }


    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        
        System.out.println(jcb_vendedoresrelatorio.getSelectedIndex());
        
        DialogoRelatorio.setVisible(false);
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jtb_atualizarvisitasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jtb_atualizarvisitasActionPerformed
        
        visitasTableModel.updateRow();
        jTable_Imprimir.setModel(visitasTableModel);
    }//GEN-LAST:event_jtb_atualizarvisitasActionPerformed

    private void jdc_DataActionPerformed() {
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("SeaGlassLookAndFeel".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(JanelaVisitas.class
                    .getName()).log(java.util.logging.Level.SEVERE, null, ex);

        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(JanelaVisitas.class
                    .getName()).log(java.util.logging.Level.SEVERE, null, ex);

        } catch (IllegalAccessException ex) {
            // java.util.logging.Logger.getLogger(Jjlab_.class, jtf_BuscarNome.getName()).log(java.util.logging.Level.SEVERE, null, ex);

        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(JanelaVisitas.class
                    .getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new JanelaVisitas().setVisible(true);
            }
        });
    }

    private void setIcon() {
        setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/visitas/hoken/imagens/h.jpeg")));
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JMenuBar BarraDeMenus;
    private javax.swing.JDialog DialogoAlteraVisita;
    private javax.swing.JDialog DialogoImprimir;
    private javax.swing.JDialog DialogoNovaVisita;
    private javax.swing.JDialog DialogoRelatorio;
    private javax.swing.JDialog DialogoVendedor;
    private javax.swing.JLabel Hoken;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLAV;
    private javax.swing.JLabel jLabCompl;
    private javax.swing.JLabel jLabDataVisita;
    private javax.swing.JLabel jLabHora;
    private javax.swing.JLabel jLabNome;
    private javax.swing.JLabel jLabObservacoes;
    private javax.swing.JLabel jLabTelCel;
    private javax.swing.JLabel jLabTelFixo;
    private javax.swing.JLabel jLabTelRec;
    private javax.swing.JLabel jLabVenP;
    private javax.swing.JLabel jLabVenS;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JLabel jLbIcone;
    private javax.swing.JLabel jLbIcone1;
    private javax.swing.JLabel jLbIcone2;
    private javax.swing.JMenuItem jMenuItem2;
    private javax.swing.JMenu jMenu_Arquivo;
    private javax.swing.JMenu jMenu_Relatorios;
    private javax.swing.JMenu jMenu_Sobre;
    private javax.swing.JMenu jMenu_Vendedores;
    private javax.swing.JMenu jMenu_Visitas;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JPopupMenu.Separator jSeparator4;
    private javax.swing.JSeparator jSeparator6;
    private javax.swing.JTable jTable_Alterar;
    private javax.swing.JTable jTable_Imprimir;
    private javax.swing.JButton jbCadastrar;
    private javax.swing.JButton jb_CancelarChange;
    private javax.swing.JButton jb_SalvarChange;
    private javax.swing.JButton jb_VisitaAlterar;
    private javax.swing.JComboBox<String> jcb_VendPrin;
    private javax.swing.JComboBox<String> jcb_VendSe;
    private javax.swing.JCheckBox jcb_canceladas;
    private javax.swing.JComboBox<String> jcb_canceladosrelatorio;
    private javax.swing.JComboBox<String> jcb_vendedoresrelatorio;
    private javax.swing.JComboBox<String> jcb_vendidorelatorio;
    private javax.swing.JCheckBox jcb_vendidos;
    private com.toedter.calendar.JDateChooser jdc_Data;
    private com.toedter.calendar.JDateChooser jdc_dataate;
    private com.toedter.calendar.JDateChooser jdc_datade;
    private javax.swing.JFormattedTextField jfHora;
    private javax.swing.JFormattedTextField jftCEP;
    private javax.swing.JFormattedTextField jftfCelular;
    private javax.swing.JFormattedTextField jftfFixo;
    private javax.swing.JFormattedTextField jftfRecado;
    private javax.swing.JList<String> jl_AlterarVisita;
    private javax.swing.JLabel jlabBairro;
    private javax.swing.JLabel jlabCEP;
    private javax.swing.JLabel jlabCidade;
    private javax.swing.JLabel jlabEndereco;
    private javax.swing.JLabel jlabEstado;
    private javax.swing.JLabel jlabIndicacao;
    private javax.swing.JMenuItem jmi_AlterarVisita;
    private javax.swing.JMenuItem jmi_Backup;
    private javax.swing.JMenuItem jmi_NovaVisita;
    private javax.swing.JMenuItem jmi_Sair;
    private javax.swing.JMenuItem jmi_listavisitas;
    private javax.swing.JMenuItem jmi_todasvisitas;
    private javax.swing.JPanel jp_alterar_salvar;
    private javax.swing.JSeparator js_Meio;
    private javax.swing.JScrollPane jsp_observacao;
    private javax.swing.JTextArea jta_observacao;
    private javax.swing.JTable jtable_visitas;
    private javax.swing.JButton jtb_atualizarvisitas;
    private javax.swing.JButton jtb_buscar;
    private javax.swing.JButton jtb_close;
    private javax.swing.JButton jtb_delete;
    private javax.swing.JButton jtb_fechar;
    private javax.swing.JButton jtb_imprimir;
    private javax.swing.JButton jtb_insert;
    private javax.swing.JButton jtb_limparfiltro;
    private javax.swing.JButton jtb_maisopcoes;
    private javax.swing.JButton jtb_save;
    private javax.swing.JButton jtb_update;
    private javax.swing.JButton jtb_vendedor;
    private javax.swing.JTextField jtfBairro;
    private javax.swing.JTextField jtfCidade;
    private javax.swing.JTextField jtfComplemento;
    private javax.swing.JTextField jtfEndereco;
    private javax.swing.JTextField jtfEstado;
    private javax.swing.JTextField jtfIndicacao;
    private javax.swing.JTextField jtfNome;
    private javax.swing.JTextField jtfSemana;
    private javax.swing.JTextField jtf_AlterarVisita;
    private javax.swing.JTextField jtf_BuscarNomeImprimir;
    private javax.swing.JCheckBox jtf_ativo;
    private javax.swing.JTextField jtf_codigoVendedor;
    private javax.swing.JTextField jtf_nome;
    private javax.swing.JTabbedPane jtp_1;
    // End of variables declaration//GEN-END:variables

    private void limparCamposNovaVisita() {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

}
